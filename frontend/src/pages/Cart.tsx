import { useEffect, useState } from "react";



interface CartItem {
    CartItemId: number;
    ItemId: number; 
    ItemQuantity: number;
    ItemName: string;   
    ItemPrice: number;    
}

function Cart() {

    const [cartItems, setCartItems] = useState([]);

    useEffect(() => {
        getCartItems();
    }, []);

    const getCartItems = async () => {
        try{ 
            const token = localStorage.getItem('token')??'string';
            console.log(token);
            const response = await fetch(`http://127.0.0.1:5197/getUserItems`, {
                method: 'GET', 
                headers: {
                'Authorization':  `${token}`,
              }});
            if (response.status == 200) {
                const data = await response.json();
                setCartItems(data.data);
                console.log(data);
            }      
        } catch (error) {
            console.log(error);
        }
    }   
    
    return (    
          <div className="mt-2 flex flex-col">
            <div className="-my-2 overflow-x-auto -mx-4 sm:-mx-6 lg:-mx-8">
              <div className="py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8">
                <div className="shadow overflow-hidden border-b border-gray-200 sm:rounded-lg">
                  <table>
                    <thead>
                      <tr>
                        <th>Name</th>
                        <th>Price</th>
                        <th>Stock</th>
                      </tr>
                    </thead>
                    <tbody>
                      {cartItems.map((item, i) => (
                      <tr key={item.id}>
                        <td>{item.ItemName}</td>
                        <td>{item.ItemPrice}</td>
                        <td>{item.ItemQuantity}</td>
                      </tr>
                      ))}  
                    </tbody>           
                  </table>    
                </div>
              </div>
            </div>
          </div>
      );
    
    
}

export default Cart;