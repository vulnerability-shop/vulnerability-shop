import random
import json
from locust import FastHttpUser
import config


def get_items_page(http: FastHttpUser, page: int = -1, size: int = 10):
    if page == -1:
        page = random.randint(1000 / size)

    http.host = http.host = config["catalog"]["host"]
    url = f'/getItems?page={page}&size={size}'
    with http.rest(method="GET", url=url) as response:
        if response.ok:
            items = json.loads(response.text)['data']['Data']
            return items
        else:
            print('Error fetching random page of items')
            exit(1)


def get_all_items(http: FastHttpUser):
    http.host = http.host = config["catalog"]["host"]
    url = '/getItems'
    with http.rest(method="GET", url=url) as response:
        if response.ok:
            items = json.loads(response.text)['data']
            return items
        else:
            print('Error fetching items in random add cart')
            exit(1)
