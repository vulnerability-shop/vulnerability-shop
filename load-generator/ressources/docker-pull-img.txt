echo "package main

import (
        \"io\";
        \"context\";
        \"fmt\";
        \"os\";
        \"github.com/docker/docker/api/types\";
        \"github.com/docker/docker/client\"
)

func main() {
        os.Setenv(\"DOCKER_API_VERSION\", \"1.39\")
        cli, err := client.NewClientWithOpts(client.FromEnv)
        if err != nil {
                panic(err)
        }
        pullCases := []struct {
                all     bool
                reference       string
                expectedImage   string
                expectedTag     string
        }{
                {
                        all: false,
                        reference: \"alpine:3.17.3\",
                        expectedImage: \"alpine\",
                        expectedTag: \"3.17.3\",
                },
        }
        for _, pullCase := range pullCases {
                resp, err := cli.ImagePull(context.Background(), pullCase.reference, types.ImagePullOptions{
                        All: pullCase.all,
                })
                if err != nil {
                        panic(err)
                }
                response, err := io.ReadAll(resp)
                if err != nil {
                    fmt.Printf(\"This is err %s\\n\", err)
                }
                if string(response) != \"response\" {
                        fmt.Printf(\"Expected response but got %s\", string(response))
                }
                fmt.Print(\"IMPORT WORKED?!\")
        }
}" > docker-pull-img.go